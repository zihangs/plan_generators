# FI-planners

More details of FI-planners are explained in this paper, [Reshaping Diverse Planning](http://www.cs.toronto.edu/~shirin/AAAI-KatzM.5922.pdf). The planners can be accessed [here](https://github.com/IBM/forbiditerative).

## Top k planner

The top k planner returns a number of k best quality plans. We used this planner in the AAMAS paper. The plans we got are plans with the lowest costs (e.g. if k = 100, then we will get the first 100 best plans starting from a lowest cost plan).

```sh
# ./plan_topk.sh <domain> <problem> <number-of-plans>
./plan_topk.sh examples/logistics00/domain.pddl examples/logistics00/probLOGISTICS-4-0.pddl 100
```

## Top quality planner

To use the top quality planner, we need set a quality-multiplier. For example, if quality-multiplier = 1.1, then this planner will return all the plans with a cost less than the lowest cost$\times$1.1, the lowest cost is the cost of an optimal plan.

```sh
# ./plan_topq_via_topk.sh <domain> <problem> <quality-multiplier>
./plan_topq_via_topk.sh examples/logistics00/domain.pddl examples/logistics00/probLOGISTICS-4-0.pddl 1.1
```

## Diverse planner

There are 3 available diverse planners, **diverse_agl**, **diverse_sat** and **diverse_bD**.

- #### Diverse_agl

The diverse_agl planner is the foundation of the diverse_sat planner and the diverse_bD planner. The diverse_agl planner is similar to the top k planner mentioned above, it will take a number-of-plan (k) as input and then will return k plans from the lowest cost plan to the plans with higher costs (k best plans). However, the difference between these two planner is whether the planner will distinguish two plans with same actions but different orders. For example, plan 1 has an action sequence <A, A, B, D, C>, plan 2 has an action sequence <B, D, A, A, C>. In the top k planner, these are **two** different plans, but the diverse_agl planner treats these as **one** plans. For the diverse_agl planner, different plans must have different sets of actions.

```sh
# ./plan_diverse_agl.sh <domain> <problem> <number-of-plans>
./plan_diverse_agl.sh examples/logistics00/domain.pddl examples/logistics00/probLOGISTICS-4-0.pddl 10
```

- #### Diverse_sat

The diverse_sat planner build on top of the diverse_agl plan. These two steps. The first step is the diverse_agl planner generating M number of plans. Then, the second step is selecting N number of plans from the plans generated by step 1. Notice that M need to be larger than N.

For the selection stage, we need to rely on some diversity metrics for filtering the valid plans. There are 3 metrics provided (currently available) which are stability, uniqueness, state. Once a metric be chosen, the diverse_sat planner will get N valid plans out of M plan candidates generated in step 1. The selecting step follows a greedy algorithm, given a currently selected plan set, it aims to add a next plan that can maximize the metric for the current selected plan set. So the output not necessarily to be the optimal N valid plans.

```powershell
## See the dependencies below (1 and 2)
# ./plan_diverse_sat.sh <domain> <problem> <number-of-plans> <diversity-metric> <larger-number-of-plans>
./plan_diverse_sat.sh examples/logistics00/domain.pddl examples/logistics00/probLOGISTICS-4-0.pddl 10 stability 20
```

For the above code, the diverse_agl planner generates 20 plans. Then, from these 20 plans, select 10 plans which can maximizing the metric (greedily).

- #### Diverse_bD

The diverse_bD planner is similar as the diverse_sat, it post-process the founded plans from diverse_agl according to one of the metrics (stability, uniqueness, state). But in the selection stage, this planner set a boundary of the metric, if a next plan can satisfy the metric boundary requirement, then it will be add into the output set.

```sh
## See the dependencies below (1, 2, and 3)
# ./plan_diverse_bounded.sh <domain> <problem> <number-of-plans> <diversity-metric> <bound> <larger-number-of-plans>
./plan_diverse_bounded.sh examples/logistics00/domain.pddl examples/logistics00/probLOGISTICS-4-0.pddl 10 stability 0.25 20
```

### Diversity metrics

pairwise dissimilarity (pairwise plan distance), $\delta(\pi,\pi')=1-sim(\pi,\pi')$

similarity measure: 0 (unrelated), 1 (equivalent), $sim(\pi,\pi')$

Diversity is the average number of pairwise dissimilarity, there are 3 different ways to calculate diversity.

1. Stability

   Related work: 

   [Plan Stability: Replanning versus Plan Repair](https://www.aaai.org/Papers/ICAPS/2006/ICAPS06-022.pdf), [Generating Diverse Plans Using Quantitative and Qualitative Plan Distance Metrics](http://www.cse.lehigh.edu/~munoz/Publications/aaai11.pdf)

   paraphase

   measures the ratio of the number of actions that appear on both plans to the total number of actions on these plans. 

   A($\pi$) is the set of actions in $\pi$.

2. Uniqueness

3. State

Related work: 

Plan Stability: [Replanning versus Plan Repair](https://www.aaai.org/Papers/ICAPS/2006/ICAPS06-022.pdf), [Generating Diverse Plans Using Quantitative and Qualitative Plan Distance Metrics](http://www.cse.lehigh.edu/~munoz/Publications/aaai11.pdf)

paraphase

measures the ratio of the number of actions that appear on both plans to the total number of actions on these plans. 

A($\pi$) is the set of actions in $\pi$.


$$
sim_{stability}=\frac{|A(\pi)\cap A(\pi')|}{|A(\pi)\cup A(\pi')|}
$$
Uniqueness:

Need to paraphase

It is another measure that considers plans as action sets. It measures whether two plans are permutations of each other, or one plan is a partial plan (subset) of the other plan.



and my graph



Related work: [Evaluating Diversity In Classical Planning](http://makro.ink/publications/robertsHoweRay14.icaps.evaluating.pdf)



State:

this is related work: [Generating diverse plans to handle unknown and partially known user preferences](https://pdf.sciencedirectassets.com/271585/1-s2.0-S0004370212X00080/1-s2.0-S0004370212000707/main.pdf?X-Amz-Security-Token=IQoJb3JpZ2luX2VjECwaCXVzLWVhc3QtMSJHMEUCIQCsAKyMu%2BlHdic4q1bNJv9AxQsNQFUnU4Io2AUZ8dw0sQIgYpMAume2lKfKlBlSnwHmdAObT%2Bv1RRZP%2FbNwMU%2BxoXsqtAMIJRADGgwwNTkwMDM1NDY4NjUiDNtqGFoUNZ22c%2B8p3SqRA9cEYq8zzdtYR2%2FIISNj34S6B%2FHVDNFSxao17q%2BGvf49d%2FUH7SbYy%2FNuZQEhoX5XkQ9U6eVu5K6nWXLey%2FDK3Yjw4kQufwSIiUI9jdJGfZMZ9XMskYLAEaIqCkwV3eVfnK1%2Fjd8LmAR%2FT%2BAdaPPn9i0%2Bc3VZraO6C1SHdsZTaiPi1DXJ7IH%2FSDWNRYeZ8sBqdajRxTiCfKNoHxjqm6TeKr4qgA4Ow%2BmjePMfsOwsTF%2BZ4wI4rq5S5LnGdNuoZ7%2FJ1u4HV5kH5dfE%2BH5v73XfD1PkW3%2FvbxXJpnyhQwFANKdmCZoKJa4KPqtoLVXUEFpREN%2Fz2qg8XmTvFivlzrkoyXMWV7z8Z8YMfOgaavjIjLWv8hwOsoKXuT7zxvRoU18pr1CVHLPspNi8xmWRGU84T%2F5wAmpeNniSOFItTR0PlRBx%2F2WtpmjL%2BMPF28qo60yht8RxEKtPgiKx9dJ%2FIe%2BzvveiAS%2F3eyFhfZtQn2cI6IuHtROBCIAqEj%2FBQa%2BJzUNPIfCfs%2Bk2hrOL6V2HDqfxAJ70MPKip%2FoFOusBhT%2F4toLNa7pVUYaxc1uNZo6U2JE6A5MIlyTIt%2Bew7ZDx95b9HmQ7sEOyR6btpQY8yX%2Bzh5sr0utdsU%2BrDZyc7xfvZH1MNofMFVwS9OBsRig2hg%2B0f7XkgAE4dG%2FZ0yF17Wpw2grLl9dwcU6G3B2VQR1xvv85dUSmIeTBr%2BnlXSH84WDJtBGOrfqnrhW4vMv6aZeDVME8tQuoTMiNl4yBdg5KwUEDcRjlbsO86Cbx2OWAIV8TPPHf8xRvtBhudZ%2B74Pb0%2BgUm%2BQ2BPsB9vN0wDpWOjWLDVmb1ktpttIyK92LEjuztLMgx3gIpOQ%3D%3D&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20200829T045538Z&X-Amz-SignedHeaders=host&X-Amz-Expires=300&X-Amz-Credential=ASIAQ3PHCVTYZQOLUWHI%2F20200829%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Signature=2896d744031c74adbb1f0aa23cecbed672eeed1a326d2af9b6efb177851b9190&hash=9a717d3306a264084b924f385a4fa80c248ef488f279adea1a2eddabd6069dd1&host=68042c943591013ac2b2430a89b270f6af2c76d8dfd086a07176afe7c76c2c61&pii=S0004370212000707&tid=spdf-97e2be54-2ac3-4b00-87e5-7984b3ffadb1&sid=f3cf60ac9edd624bad58ecc9a2519d473821gxrqa&type=client)



mkdocs:

https://www.mkdocs.org/user-guide/deploying-your-docs/





The homomorphism $f$ is injective if and only if its kernel is only the  singleton set $e_G$, because otherwise $\exists a,b\in G$ with $a\neq b$ such  that $f(a)=f(b)$.